<!DOCTYPE html>
<html>

<head>
    <title>Sokoban</title>
    <style>
        #game-container {
            width: 320px;
            height: 320px;
            border: 1px solid black;
        }
    </style>
</head>

<body>
    <div id="game-container"></div>
    <script>
        const level = [
            "######",
            "#.   #",
            "#$   #",
            "#@   #",
            "#    #",
            "######"
        ];

        const playerChar = "@";
        const boxChar = "$";
        const goalChar = ".";
        const wallChar = "#";

        const gameState = {
            level,
            playerX: 1,
            playerY: 3,
            boxes: [{ x: 1, y: 2 }],
            goals: [{ x: 1, y: 1 }]
        };

        function renderGameState() {
            const gameContainer = document.getElementById("game-container");
            gameContainer.innerHTML = "";

            for (let y = 0; y < gameState.level.length; y++) {
                const row = gameState.level[y].split("");

                for (let x = 0; x < row.length; x++) {
                    const char = row[x];
                    const cell = document.createElement("div");
                    cell.style.width = "32px";
                    cell.style.height = "32px";
                    cell.style.display = "inline-block";

                    if (char === playerChar) {
                        cell.innerText = playerChar;
                    } else if (char === boxChar) {
                        cell.innerText = boxChar;
                    } else if (char === goalChar) {
                        cell.innerText = goalChar;
                    } else if (char === wallChar) {
                        cell.style.backgroundColor = "black";
                    }

                    gameContainer.appendChild(cell);
                }

                gameContainer.appendChild(document.createElement("br"));
            }
        }

        function movePlayer(dx, dy) {
            const newX = gameState.playerX + dx;
            const newY = gameState.playerY + dy;

            if (gameState.level[newY][newX] === wallChar) {
                return;
            }

            const boxIndex = gameState.boxes.findIndex(box => box.x === newX && box.y === newY);

            if (boxIndex !== -1) {
                const newBoxX = newX + dx;
                const newBoxY = newY + dy;

                if (gameState.level[newBoxY][newBoxX] === wallChar) {
                    return;
                }

                if (gameState.boxes.findIndex(box => box.x === newBoxX && box.y === newBoxY) !== -1) {
                    return;
                }

                gameState.boxes[boxIndex].x = newBoxX;
                gameState.boxes[boxIndex].y = newBoxY;
            }

            gameState.playerX = newX;
            gameState.playerY = newY;

            renderGameState();
        }

        function handleKeyPress(event) {
            if (event.key === "ArrowLeft") {
                movePlayer(-1, 0);
            } else if (event.key === "ArrowRight") {
                movePlayer(1, 0);
            } else if (event.key === "ArrowUp") {
                movePlayer(0, -1);
            } else if (event.key === "ArrowDown") {
                movePlayer(0, 1);
            }
        }

        renderGameState();

        document.addEventListener("keydown", handleKeyPress);
    </script>
</body>

</html>